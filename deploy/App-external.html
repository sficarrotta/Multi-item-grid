<!DOCTYPE html>
<html>
<head>
    <title>MixedTypeGrid</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.0rc3/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){this._myModels=[],this._boxcontainer=Ext.create("Ext.form.Panel",{title:"Select the Type of Items to Display in the Grid",width:500,bodyPadding:10,items:[{xtype:"checkboxgroup",columns:3,vertical:!0,listeners:{change:this._onCheck,scope:this},items:[{boxLabel:"Stories",name:"userstory",checked:!0},{boxLabel:"Defects",name:"defect",checked:!1},{boxLabel:"Features",name:"portfolioitem/feature",checked:!1}],scope:this}]}),this.add(this._boxcontainer);var filter="",timeboxScope=this.getContext().getTimeboxScope();timeboxScope&&(filter=timeboxScope.getQueryFilter()),this._myGrid=this.add({xtype:"rallygrid",enableBulkEdit:!0,columnCfgs:["FormattedID","Name","ScheduleState","Owner"],context:this.getContext(),storeConfig:{models:["userstory"],filters:[filter]}})},_onCheck:function(obj,value){var that=this,models=[];if(obj){console.log("obj: ",obj);var values=obj.getChecked();if(0===values.length)return alert("No Items Checked! You must select at least one item type"),void 0;var model;Ext.Array.each(values,function(type){model=type.getName(),console.log("model: ",model),models.push(model)}),console.log("grid: ",that._myGrid),that._myGrid.reconfigureWithModel(models);var filter="",timeboxScope=this.getContext().getTimeboxScope();timeboxScope&&(filter=timeboxScope.getQueryFilter());var store=this._myGrid.getStore();store.clearFilter(!0),store.filter(filter)}else console.log("Nothing checked"),alert("No Items Checked! You must select at least one work item type")},_updateGrid:function(myStore){console.log("Updating Grid"),this._myGrid.reconfigure(myStore)},onTimeboxScopeChange:function(newTimeboxScope){var newFilter=newTimeboxScope.getQueryFilter(),store=this._myGrid.getStore();store.clearFilter(!0),store.filter(newFilter),this._updateGrid(store)}});

            Rally.launchApp('CustomApp', {
                name:"MixedTypeGrid",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
